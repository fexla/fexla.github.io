---
title: 动态属性网络框架-1 前言
author: fexla
date: 2021-11-11
categories: [游戏, 框架设计]
tags: [游戏, 游戏开发, 框架设计, 动态数值网络, 数值, 编程]
---
## 简介

　　我最近设计开发了一个游戏数值（程序，）框架，我将它命名为动态属性网络（节点是动态属性的动态网络），其作用是用一个可视化的、动态的数值模型，维护多级属性的所有属性之间的**运算关系**，和维护数值载体身上的**一系列数值**。它**适用于开发数值属性非常多的游戏**，如太吾绘卷、鬼谷八荒、群星。

　　我的基本想法是：以太吾绘卷为例（觉得文字太繁琐可以直接看我的示意图），太吾绘卷有非常多的属性种类，属性之间又会互相影响。首先是人物五维：膂力、体质、灵敏、根骨、悟性、定力（众所周知五维有六个）五维，然后是技艺/功法水平，加起来共30种，每一种由先天资质加后天造诣相加算出，资质属性又会受到年龄的影响。人物会有很多功法，每个功法有特定的功法需求，功法需求会有若干个五维和技艺/功法水平的要求，人物对应的属性值低于要求时功法带来的属性加成和功法威力会降低，反之亦然，另一方面功法学习进度也会影响。由上面这些属性又会推导出几十种战斗中直接用到的属性，会影响内/外伤害，移动速度，招式/平a回转速度，招式生效段数，平a连击概率等等。除此之外还有内功产生的五种内力数量（五行内力）、玩家自己分配的摧破、轻灵、护体、奇窍点数、精纯境界。

![IcRRZq.png](https://z3.ax1x.com/2021/11/14/IcRRZq.png)

　　很容易发现的是，我们几乎没法用一个公式直接算出一个最终属性的值，我们要先把底层的数值算出来，然后一层一层推算到最后。在动态属性框架中，把一个不可再分的属性（即上图的一个大方块中的一行）看做一个节点，节点之间的运算逻辑连接相关节点，比如剑法资质、剑法造诣、剑法水平看做三个属性节点，剑法资质节点和剑法水平节点之间有一条连线，同理剑法造诣节点和剑法水平节点之间有一条连线。在这个框架中，把所有属性抽象为节点，于是可以动态地、可视化地增加删除属性和属性之间的运算关系。最终节点和节点相连的效果就是形成网络。

## 概念解释

　　这里有动态属性网络模型和属性集。

　　什么是动态属性呢？这里的定义就是这个属性会因为其他某个或某几个属性的变化而变化，就是动态属性。

　　属性网络模型保存了属性之间的运算关系，属性集保存了一系列实际的属性实例。属性网络模型是游戏开发阶段，由开发人员编辑出属性之间的关系，属性集在游戏运行时产生，是实际的属性。属性集要按照某一个模型构建，属性网络模型可以依靠属性之间的运算关系对属性集操作（比如得到某个属性的值）。如果属性集由模型A构建，那么它只能被模型A操作。

　　举个具体的例子就是假设有个“战斗单位”的属性模型，描述了力量和攻击力之间的运算关系（比如力量直接加到攻击力上），玩家A，玩家B，NPC_A，NPC_B都分别有一个属性集，都是按照“战斗单位”这个属性模型构建的，他们的属性集包括力量，攻击力这两个属性。

　　还有一些更具体的功能，比如
- 函数式属性（本身是一个属性模型，用于技能输出的计算）
- 网络依附（一个属性集依附到另一个属性上，用于多对一的关系，比如一个人穿4个装备）
- 属性类型从属（用于一次性影响多个属性，比如群星中一个科技增加2%所有人口的产出）

　　这些功能先放着，之后的文章再详细写。

## 优缺点

这个框架的优点有：

- 可视化编辑属性模型，由节点表示运算关系，比公式直观。

- 可以在每个节点设置缓存，可以空间换时间，减少运算量，尤其对于底层数值不易改变的场景。

- 属性模型可以热更新，即运算公式可以热更新。因为属性模型可以序列化。

- 因为完全用图形化界面，所以属性类型的枚举不用在c#中写，而是用图形化界面操作一个int到类型信息的表。

- 可以直接用字符串指代属性类型而不用写枚举。（因为字符串哈希的运算量，只在中间属性使用并且没有buff附加到它身上才不会影响性能

这个框架的缺点有：

- 网络无法处理循环连接。

- 等实现出来再看有什么缺点。

## 修改记录

　　2021/11/14 发现讲的不清楚，于是加上了太吾绘卷的例子，修改了一些说法。
